{% extends "base/base.html"%} {% block start %}
{% load static %}
<style>
  .filter-section {
      margin-bottom: 20px;
  }

  .form-group {
      margin-bottom: 10px;
  }

  @keyframes appear {
    from {
      opacity: 0;
      scale: 0.5;
    }
    to {
      opacity: 1;
      scale: 1;
    }
  }

  .card {
    animation: appear linear;
    animation-timeline: view();
    animation-range: entry 0% cover 40%;
  }
</style>

<style>
  #billboardCarousel {
    max-height: 75vh;
    position: relative;
    overflow: hidden;
  }

  #billboardCarousel .carousel-item img {
    height: 75vh;
    object-fit: cover;
    width: 100%;
  }

  .carousel-overlay {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
    background: rgba(0, 0, 0, 0.3); /* semi-transparent dark overlay */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    z-index: 2;
    padding: 20px;
    pointer-events: none; /* Let clicks go through by default */
  }

  .carousel-overlay img.logo {
    max-height: 80px;
    margin-bottom: 20px;
  }

  .carousel-overlay .btn-shop {
    pointer-events: auto; /* These elements can still be clicked */
    padding: 10px 20px;
    font-size: 1.1rem;
  }
</style>

<style>
  .brand-carousel {
    position: absolute;
    bottom: 0;
    width: 100%;
    background: linear-gradient(to top, white, transparent); /* adjust to your theme */
    padding: 10px 0;
    z-index: 50;
  }

  .brand-carousel .brand-logo {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 0 15px;
  }

  .brand-carousel img {
    height: 60px;
    object-fit: contain;
    filter: drop-shadow(0px 3px 5px rgba(0, 0, 0, 0.4)); /* true drop shadow */
  }
</style>

<div class="container mt-3 pt-3">
  {% include 'base/alert.html' %}

<div id="billboardCarousel" class="carousel slide mb-5" data-bs-ride="carousel">
  <!-- Main billboard images -->
  <div class="carousel-inner">
    {% for billboard in billboards %}
    <div class="carousel-item {% if forloop.first %}active{% endif %}">
      <img src="/media/{{ billboard.image }}" alt="Billboard Image">
    </div>
    {% endfor %}
  </div>

  <!-- Overlay with logo, shop button, and brand carousel -->
  <div class="carousel-overlay">
    <img src="{% static 'images/white_village_tech_logo.png' %}" alt="Shop Logo" class="logo">
    <a href="#shop-section" class="btn btn-primary btn-shop">Shop</a>

    <!-- Brand carousel -->
    <div class="brand-carousel slick-slider">
  {% for brand in brands %}
    <div class="brand-logo">
      <img src="/media/{{ brand.image }}" alt="{{ brand.name }}">
    </div>
  {% endfor %}
</div>

  </div>
</div>



    <!-- Carousel Controls -->
    <button class="carousel-control-prev" type="button" data-bs-target="#billboardCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#billboardCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
    </button>
  </div>


  <!-- Section Header for Below Content -->
  <section id="shop-section" class="mt-5 mb-3">
    <!-- Slider Header Banner -->
      <div class="header-banner slide-up" aria-hidden="false">
        <div class="container">
          <div class="d-flex justify-content-center">
            <div class="html-slot-container">
              <input type="hidden" id="endTime" value="null" />
              <div class="content mb-3 text-align-center" text-align="center">
                <h5 class="shop-label mt-2"><b>Village Tech Official Shop</b></h5>
              </div>
            </div>
          </div>
        </div>
      </div>
  </section>


  <!-- Filter Section -->
  <div class="filter-section mb-3">
    <form method="GET" class="row">
      <div class="form-group col-md-6">
        <label for="category">Category:</label>
        <select id="category" name="category" class="form-control" onchange="this.form.submit()">
          <option value="">All</option>
          {% for category in categories %}
          <option value="{{ category.category_name }}" {% if selected_category == category.category_name %} selected {% endif %}>
            {{ category.category_name }}
          </option>
          {% endfor %}
        </select>
      </div>
      
      <!-- Sort Section -->
      <div class="form-group col-md-6">
        <label for="sort">Sort by:</label>
        <select id="sort" name="sort" class="form-control" onchange="this.form.submit()">
          <option value="">Select</option>
          <option value="newest" {% if selected_sort == 'newest' %}selected{% endif %}>Newest</option>
          <option value="priceAsc" {% if selected_sort == 'priceAsc' %}selected{% endif %}>Price: Low-High</option>
          <option value="priceDesc" {% if selected_sort == 'priceDesc' %}selected{% endif %}>Price: High-Low</option>
        </select>
      </div>
    </form>
  </div>

  <!-- Product List -->
  <div class="row">
    {% for product in products %}
    <div class="col-md-3">
      <figure class="card card-product-grid">
        <div class="img-wrap">
          <img src="/media/{{product.product_images.first.image}}" />
        </div>
        <figcaption class="info-wrap border-top">
          <a href="{% url 'get_product' product.slug %}" class="title">
            <b>{{ product.product_name }}</b></a>
          <div class="price mt-2">${{product.price}}.00</div>
        </figcaption>
      </figure>
    </div>
    {% endfor %}
  </div>

  <!-- Pagination Section -->
  <nav aria-label="Page navigation example">
    <ul class="pagination justify-content-center mb-4">
      {% if products.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?page={{ products.previous_page_number }}" aria-label="Previous">
          <span aria-hidden="true">&laquo; Previous</span>
        </a>
      </li>
      {% else %}
      <li class="page-item disabled">
        <a class="page-link">Previous</a>
      </li>
      {% endif %}

      {% for num in products.paginator.page_range %}
      <li class="page-item {% if products.number == num %}active{% endif %}">
        <a class="page-link" href="?page={{ num }}">{{ num }}</a>
      </li>
      {% endfor %}

      {% if products.has_next %}
      <li class="page-item">
        <a class="page-link" href="?page={{ products.next_page_number }}" aria-label="Next">
          <span aria-hidden="true">Next &raquo;</span>
        </a>
      </li>
      {% else %}
      <li class="page-item disabled">
        <a class="page-link">Next</a>
      </li>
      {% endif %}
    </ul>
  </nav>
  
</div>

<script>
  $(document).ready(function () {
    $('.brand-carousel').slick({
      slidesToShow: 6,
      slidesToScroll: 1,
      autoplay: true,
      autoplaySpeed: 0,
      speed: 5000,
      cssEase: 'linear',
      infinite: true,
      arrows: false,
      dots: false,
      pauseOnHover: false,
      variableWidth: true
    });
  });
</script>

{% endblock %}
